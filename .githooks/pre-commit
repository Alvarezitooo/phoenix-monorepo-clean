#!/bin/bash
# ðŸ”§ Auto cache-bust pour Railway
# Se dÃ©clenche automatiquement avant chaque commit

TIMESTAMP=$(date +"%Y-%m-%d-%H:%M:%S")

# Mettre Ã  jour le fichier version
echo "$TIMESTAMP" > apps/phoenix-backend-unified/version.txt

# Mettre Ã  jour le Dockerfile
sed -i.bak "s/CACHE BUST.*$/CACHE BUST $TIMESTAMP/" apps/phoenix-backend-unified/Dockerfile

# Ajouter les fichiers modifiÃ©s
git add apps/phoenix-backend-unified/version.txt
git add apps/phoenix-backend-unified/Dockerfile

# Nettoyage
rm -f apps/phoenix-backend-unified/Dockerfile.bak

echo "ðŸš€ Cache-bust automatique appliquÃ©: $TIMESTAMP"